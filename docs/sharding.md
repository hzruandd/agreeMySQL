#垂直切分

##垂直切分的优点
数据库的拆分简单明了,拆分规则明确;

应用程序模块清晰明确,整合容易;

数据维护方便易行,容易定位;
##垂直切分的缺点
部分表关联无法在数据库级别完成,需要在程序中完成;

对于访问极其频繁且数据量超大的表仍然存在性能平静,不一定能满足要求; 

事务处理相对更为复杂;

切分达到一定程度之后,扩展性会遇到限制;

过读切分可能会带来系统过渡复杂而难以维护。


#水平切分

如根据某个数字类型字段基于特定数目取模, 某个时间类型字段的范围,或者是某个字类符 型字段的 hash 值。
如果整个系统中大部分核心表都可以通过某个字段来进行关联, 那个这字段自然是一个
进行水平分区的上上之选了,当然,非常特殊无法使用就只能另选其他了。

一般来说,像现在互联网非常火爆的Web2.0 类型的网站,基本上大部分数据都能够通
过会员用户信息关联上,可能很多核心表都非常适合通过会员ID 来进行数据的水平切分。
而像论坛社区讨论系统,就更容易切分了,非常容易按照论坛编号来进行数据的水平切分。
切分之后基本上不会出现各个库之间的交互。


###不管如何切分，尽量保障基本上每个用户相关的数据, 都在同一个数据库中, 即使是需要关联,
###也可以非常简单关联上。


##水平切分的优点
表关联基本能够在数据库端全部完成;

不会存在某些超大型数据量和高负载的表遇到瓶颈的问题; 

应用程序端整体架构改动相对较少;

事务处理相对简单;

只要切分规则能够定义好,基本上较难遇到扩展性限制;

##水平切分的缺点

切分规则相对更为复杂,很难抽象出一个能够满足整个数据库的切分规则; 

后期数据的维护难度有所增加,人为手工定位数据更困难;

应用系统各模块耦合度较高,可能会对后面数据的迁移拆分造成一定的困难。

====================

#联合切分的优点

可以充分利用垂直切分和水平切分各自的优势而避免各自的缺陷; 

让系统扩展性得到最大化提升;

#联合切分的缺点

数据库系统架构比较复杂,维护难度更大;

应用程序架构也相对更复杂;


===================================
#利用 MySQL Proxy 实现数据切分及整合
MySQL Proxy 是 MySQL 官方提供的一个数据库代理层产品,和 MySQL Server 一样,
同样是一个基于 GPL 开源协议的开源产品。可用来监视、分析或者传输他们之间的通讯信
息。他的灵活性允许你最大限度的使用它,目前具备的功能主要有连接路由,Query 分析,
Query 过滤和修改,负载均衡,以及基本的 HA 机制等。
实际上,MySQL Proxy 本身并不具有上述所有的这些功能,而是提供了实现上述功能的
基础。要实现这些功能,还需要通过我们自行编写 LUA 脚本来实现。
MySQL Proxy 实际上是在客户端请求与 MySQL Server 之间建立了一个连接池。 所客有
户端请求都是发向 MySQL Proxy,然后经由 MySQL Proxy 进行相应的分析,判断出是读操
作还是写操作,分发至对应的 MySQL Server 上。对于多节点 Slave 集群,也可以起做到
负载均衡的效果。


#利用 Amoeba 实现数据切分及整合
Amoeba 是一个基于 Java 开发的, 专注于解决分布式数据库数据源整合Proxy 程序的
开源框架,基于 GPL3 开源协议。目前,Amoeba 已经具有 Query 路由,Query 过滤,读写
分离,负载均衡以及 HA 机制等相关内容。
##Amoeba 主要解决的以下几个问题:
1. 数据切分后复杂数据源整合;

2. 提供数据切分规则并降低数据切分规则给数据库带来的影响; 

3.降低数据库与客户端的连接数;

4. 读写分离路由;



#利用 HiveDB 实现数据切分及整合
和前面的 MySQL Proxy 以及 Amoeba 一样,HiveDB 同样是一个基于 Java 针对 MySQL
数据库的提供数据切分及整合的开源框架,只是目前的 HiveDB 仅仅支持数据的水平切分。
主要解决大数据量下数据库的扩展性及数据的高性能访问问题,
同时支持数据的冗余及本基 的 HA 机制。
HiveDB 的实现机制与 MySQL Proxy 和 Amoeba 有一定的差异,他并不是借助 MySQL 的
Replication 功能来实现数据的冗余,而是自行实现了数据冗余机制,而其底层主要是 基于
Hibernate Shards 来实现的数据切分工作.
在 HiveDB 中, 通过用户自定义的各种Partition keys (其实就是制定数据切分规则),
将数据分散到多个 MySQL Server 中。在访问的时候,在运行 Query 请求的时候,会自动
分析过滤条件,并行从多个MySQL Server 中读取数据,并合并结果集返回给客户端应用程
序。



====================
#数据切分与整合中可能存在的问题
##遇到的问题主要会有以下几点:
引入分布式事务的问题; 

跨节点 Join 的问题;

跨节点合并排序分页问题;



